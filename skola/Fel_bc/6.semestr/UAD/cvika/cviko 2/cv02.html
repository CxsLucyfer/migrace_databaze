<?xml version="1.0" encoding="iso-8859-2" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="cz" dir="ltr">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-2" />
<meta name="generator" content="Myself" />
<meta name="keywords" content="UNIX administration" />
<meta name="author" content="Jan ®ïárek &lt;cz.cvut.fel_._zdarekj&gt;" />

<title>Y36UAD -- Správa u¾ivatelù</title>
<link rel="stylesheet" type="text/css" href="./uad.css" />
</head>
<!-- Last 29.3.2008, 99, valid X -->

<body> 
<h1>Správa u¾ivatelù</h1>
<hr />
<h2>Externí identita, u¾ivatelé</h2>
<p>
U¾ivatelé systému jsou definováni v&nbsp;souboru <code>/etc/passwd</code>, 
v¾dy jeden u¾ivatel na ka¾dé øádce. Ka¾dá øádka ma celkem 7 sloupcù oddìlených 
dvojteèkou. Zopakujte si jejich význam podle pøedná¹ky <em>Administrace 
u¾ivatelù</em>.
</p>
<h3>Úkol 1</h3>
<p>
Srovnejte údaje uvedené na pøedná¹ce s&nbsp;aktuální verzí dokumentace 
systému o souboru <abbr title="Hint: passwd(5)"><code>passwd</code></abbr>.
</p>
<p>
Hesla a parametry jejich platnosti jsou ulo¾ena v&nbsp;za¹ifrované podobì 
v&nbsp;souboru <code>/etc/<abbr title="Hint: shadow(5)">shadow</abbr></code>, 
který má velice podobnou strukturu. 
</p>
<h3>Úkol 2</h3>
<p>
Pøesný význam jednotlivých polo¾ek souboru <code>/etc/shadow</code> 
byl diskutován na pøedná¹ce, srovnejte tyto údaje s&nbsp;dokumentací systému.
</p>
<h2>Pøidávání u¾ivatelù &ndash; nástroje <code>user*</code></h2>
<h3>Pøehled vybraných parametrù nástrojù správy u¾ivatelù</h3>
<p>
<tt>useradd</tt> i <tt>userdel</tt> lze pou¾ít zcela jednodu¹e, napø.:<br />
<tt>useradd loginname</tt><br />
</p>
<p>
Chceme-li nastavit nìkteré vlastnosti ruènì, lze to pomocí volitelných 
parametrù.
</p>
<table>
<tr><td><tt>useradd</tt></td><td><code>-u UID</code></td><td>UID nového u¾ivatele</td></tr>
<tr><td><tt></tt></td><td><code>-g GID</code></td><td>primární GID</td></tr>
<tr><td><tt></tt></td><td><code>-G GID1,GID2,...</code></td><td>sekundární GID</td></tr>
<tr><td><tt></tt></td><td><code>-m</code></td><td>vytvoøit domovský adresáø</td></tr>
<tr><td><tt></tt></td><td><code>-s shell</code></td><td>login shell</td></tr>
<tr><td><tt>userdel</tt></td><td><code>-r</code></td><td>Sma¾e úèet vèetnì domovského adresáøe a souboru s do¹lou po¹tou.</td></tr>
</table>
<p>
Vyzkou¹ejte si pøidat a odebrat u¾ivatele. Vyu¾ijte pøíkazy 
<abbr title="Hint: useradd(8)"><code>useradd</code></abbr>, <abbr title="Hint: userdel(8)"><code>userdel</code></abbr> a <code>usermod</code>. 
Sledujte, jak se mìní soubor <code>/etc/passwd</code> a <code>/etc/group</code>.
Zkuste mìnit také hesla a sledovat soubor <code>/etc/shadow</code>.
</p>
<p>
Zajistí nástroje <code>user*</code> v¹echny operace, které jsou potøeba pro 
úspì¹né pøidání u¾ivatele?
</p>
<h3>Úkol 3</h3>
<p>
Ovìøte si správnost své odpovìdi na pøedchozí otázku tímto pøíkladem:
</p>
<ol>
  <li>Zalo¾te nového u¾ivatele pøíkazem <tt>useradd</tt>.</li>
  <li>Pøihla¹te se na jeho úèet a vytvoøte soubor <tt>soubor</tt> v adresáøi <tt>/tmp</tt>.</li>
  <li>Odhlaste u¾ivatele.</li>
  <li>Zru¹te u¾ivatele pøíkazem <tt>userdel</tt>, resp. <tt>userdel -r</tt>.</li>
</ol>
<p>
<b>Zmìnu identity v bì¾ícím shellu provedeme pøíkazem <tt><abbr title="Hint: su(1)">su</abbr> - <i>loginname</i></tt>.</b>
</p>
<h2>Pøidávání u¾ivatelù &ndash; ruènì</h2>
<p>
Nyní zkuste pøidat u¾ivatele ruènì (podle postupu uvedeného na pøedná¹ce), 
tj.&nbsp;vytvoøit pøíslu¹né øádky 
v&nbsp;<code>/etc/passwd</code>, <code>/etc/shadow</code> a pøípadnì 
v&nbsp;<code>/etc/group</code> pomocí obyèejného textového editoru.
Jako editor je nejlep¹í pou¾ít <code>vipw</code>, pomocí promìnné
prostøedí <code>EDITOR</code> si mù¾ete nastavit jiný editor, ne¾ je 
implicitní <code>vi</code>, jako napøíklad <code>joe</code> nebo <code>emacs</code>, 
pøípadnì nìkterý grafický editor pro X11 (<code>xedit</code>).
</p>
<h3>Úkol 4</h3>
<p>
Vyzkou¹ejte, co se stane pøi spu¹tìní druhého a dal¹ího editoru <code>vipw</code>.
Je takové chování u¾iteèné? <!--(Pokud si nejste jisti, konsultujte svùj názor 
s&nbsp;va¹ím cvièícím.)-->
</p>
<h2>Interní identita &ndash; UID/GID</h2>
<p>
Vlastník jednotlivých objektù v UNIXu (soubor, proces) 
je identifikován v¾dy jen pomocí UID, to znamená, ¾e je ulo¾eno 
(na disku, v&nbsp;pamìti) jen UID a kdy¾ chce kterýkoliv program vypsat 
skuteèného vlastníka, musí si ho dohledat v&nbsp;databázi u¾ivatelù, 
napø.&nbsp;<code>/etc/passwd</code>. 
</p>
<h3>Úkol 5</h3>
<ol>
  <li>Pøidejte nového u¾ivatele <code>victim</code> a pøihla¹te se na jeho úèet.</li>
  <li>Vytvoøte nìjaké soubory, spus»te na pozadí nìkolik procesù.</li>
  <li>Odeberte øádky týkající se u¾ivatele <code>victim</code> ze souborù
      <code>/etc/passwd</code>, <code>/etc/shadow</code> a pøípadnì <code>/etc/group</code>.
      Pozor, <code>userdel</code> by vám nemìl z&nbsp;pochopitelných dùvodù 
      odebrání pøihlá¹eného u¾ivatele dovolit. Je nutné to provést ruènì, nebo 
      zadat pøíkazu <tt>userdel</tt> parametr <tt>-f</tt>.</li>
  <li>Jak se nyní systém chová? Ovìøte:
  <ol style="list-style-type: lower-alpha;">
    <li>pøihla¹ování,</li>
    <li>vlastnictví souborù, <code>ls(1)</code></li>
    <li>vlastnictví procesù, <code>ps(1)</code></li>
    <li>identitu pøihlá¹eného u¾ivatele. <code>id(1)</code></li>
  </ol></li>
</ol>
<h3>Úkol 6</h3>
<p>
Vyzkou¹ejte a vysvìtlete následující chování:
</p>
<ol>
  <li>Zalo¾te nového u¾ivatele <tt>sef</tt>.</li>
  <li>Zkontrolujte, zda adresáø <tt>/home/sef</tt> vlastní u¾ivatel <tt>sef</tt>.</li>
  <li>Zru¹te u¾ivatele <tt>sef</tt>, ale ponechte jeho domovský adresáø.</li>
  <li>Zalo¾te nového u¾ivatele <tt>ucetni</tt>.</li>
  <li>Podívejte se, kdo vlastní adresáø <tt>/home/sef</tt>. Proè?</li>
  <li>Zru¹te u¾ivatele <tt>ucetni</tt>.</li>
  <li>Podívejte se, kdo vlastní adresáø <tt>/home/sef</tt> nyní.</li>
</ol>
<h3>Úkol 7</h3>
<p>
Pøidejte nového u¾ivatele <tt>admin</tt>. Nastavte jeho UID na nulu.
(<tt>useradd -o</tt>.)
Pøihlaste se jako u¾ivatel <tt>admin</tt> a ovìøte identitu novì vytváøených 
souborù a procesù.
</p>
<h3>Bodované úlohy</h3>
<p>
Vyøe¹te bodované úlohy zadané cvièícím a pøedveïte mu jejich správná øe¹ení.
</p>
<hr />
<p><img src="../obr/ESFgrant.png" width="161" height="22" alt="Partially supported by ESF and City of Prague." /></p>
</body>
</html>

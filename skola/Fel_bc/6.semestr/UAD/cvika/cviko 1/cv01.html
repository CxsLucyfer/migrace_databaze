<?xml version="1.0" encoding="iso-8859-2" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="cz" dir="ltr">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-2" />
<meta name="keywords" content="UNIX administration" />

<title>Y36UAD -- Správa software, instalace oprav</title>
<link rel="stylesheet" type="text/css" href="./uad.css" />
</head>
<!-- 75, XHTML-strict 11.2.2011 -->

<body> 
<h1>Seznámení s prostøedím, správa software, instalace oprav</h1>
<hr />
<h2>Instalace balíèkù software</h2>
<p>
Pou¾ívaný software bývá dnes tvoøen øadou souborù, nejen spustitelných 
(a souborù knihoven), ale i soubory dokumentace, spou¹tìcími skripty,
konfiguraèními soubory aj. Distribuce software tedy probíhá pomocí tzv.&nbsp;
balíèkù, a» u¾ to jsou nejjednodu¹¹í klasické zabalené archivy souborù, 
nebo sofistikované balíèky nìkterých distribucí, které umí provést instalaci a
odinstalování balíèku i poèáteèní implicitní konfiguraci pro danou platformu.
Ka¾dý u¾ivatel chce nìco jiného, proto rùzné UNIXy a rùzné GNU/Linux distribuce 
podporují rùzné formy distribuce a správy SW.
</p>
<p>
Zásadní rozdíl ,,chytrého" balíèku a obyèejného archivu spoèívá ve 
stanovení tzv.&nbsp;závislostí, tj.&nbsp;schopnost vy¾ádat si instalaci
nebo upgrade dal¹ích potøebných souborù a jim odpovídajícím balíèkùm, 
typicky balíèkù s&nbsp;pou¾itými knihovnami.
V&nbsp;poslední dobì ale slo¾itost vazeb narùstá a snaha o aktualizaci 
jednoho programu mù¾e vést i k&nbsp;indukované aktualizaci tøeba desítek 
podpùrných balíèkù.
</p>
<p>
Dal¹í výhodou jsou instalaèní a odinstalaèní skripty, automatizující 
pøidání resp.&nbsp;odstranìní ze systému. Odinstalování ale (obvykle) odstraní 
jen primární balíèek, nikoliv (èasto poèetné) závislosti. Nìkteré 
balíèkovací systémy ale umí tyto potenciálnì zbyteèné balíèky zjistit.
Na v¹ech systémech, které podporují alespoò zji¹tìní v¹ech nainstalovaných 
balíèkù a jejich pøímých závislostí, mù¾eme ale zbyteèné balíèky 
identifikovat sami.
</p>
<h2>Systém balíèkù RPM</h2>
<p>
Distribuce RedHat/SUSE/Fedora a dal¹í pou¾ívají balíèky formátu RPM, 
který se u¾ staèil stát standardem. V&nbsp;distribucích, které RPM nepou¾ívají, 
se obvykle nacházejí nástroje na konverzi z&nbsp;RPM do balíèku dané distribuce 
a pøípadnì i naopak.
</p>
<p>
RPM obsahuje preinstalaèní a postinstalaèní skripty, informace o názvu
balíèku, detailní popis funkce, verzi, informace o autorovi, datum
vytvoøení, název balíèku se zdrojovým kódem, atd.  
Významnou informací je seznam identifikátorù vlastností (rozhraní, 
<em>capabilities</em>),
které balíèek nabízí, a dále seznam identifikátorù vlastností, které pro svou
práci potøebuje. Tak lze zcela automaticky kontrolovat závislosti mezi
balíèky a upozoròovat na pøípadnou nefunkènost z dùvodù pou¾ívaného
programu, který v¹ak není nainstalován, pøípadnì rovnou nechat potøebné
závislosti stáhnout z&nbsp;Internetu a nainstalovat.
</p>
<p>
Správu balíèkù RPM provádíme pøíkazem <code>rpm</code>. Program <code>rpm</code>
pracuje v&nbsp;nìkolika módech:
</p>
<table>
<tr><td><b>Instalace</b></td><td><code>rpm -i balik.rpm</code></td>
    <td>Nainstaluje pøísku¹ný balík.rpm</td></tr>
<tr><td><b>Odinstalování</b></td><td><code>rpm -e balik</code></td>
    <td>Odinstaluje nainstalovaný balík</td></tr>
<tr><td rowspan="9" style="vertical-align: top;"><b>Dotaz</b></td>
    <td><code>rpm -q -a</code></td><td>Zobrazí seznam nainstalovaných balíèkù.</td></tr>
<tr><td><code>rpm -q -i balik</code></td><td> Informace o nainstalovaném balíèku <code>balik</code>.</td></tr>
<tr><td><code>rpm -q -p -i balik.rpm</code></td><td> Informace o nenainstalovaném 
        balíèku <code>balik.rpm</code>.</td></tr>
<tr><td><code>rpm -q -g <i>group_name</i></code></td><td>Vypí¹e balíèky patøící
        do skupiny balíèkù <code><i>group_name</i></code>.</td></tr>
<tr><td><code>rpm -q -f /dir/file</code></td><td>Ke kterému balíèku patøí soubor
        <code>/dir/file</code>.</td></tr>
<tr><td><code>rpm -q --provides balik</code></td><td> Které vlastnosti 
        implementuje (nabízí) balíèek <code>balik</code>.</td></tr>
<tr><td><code>rpm -q --requires balik</code></td><td> Které vlastnosti ke 
        své èinnosti potøebuje balík <code>balik</code>.</td></tr>
<tr><td><code>rpm -q --whatprovides</code> C</td><td> Vypí¹e balíky, které
        implementují (nabízí) vlastnost C.</td></tr>
<tr><td><code>rpm -q --whatrequires</code> C</td><td> Vypí¹e balíky, které 
        potøebují ke své èinnosti vlastnost C.</td></tr>
</table>
<p>
Na Internetu existují rozsáhlé archivy RPM balíèkù, které lze stáhnout a
okam¾itì nainstalovat. 
</p>
<h3>YUM</h3>
<p>
Dal¹í významnou pomocí administrátora je systém automatizovaného získávání
balíèkù a udr¾ování jejich aktuálních verzí. Distribuce Fedora pou¾ívá
systém YUM. YUM pracuje s RPM balíèky. Umí stáhnout potøebný balíèek, 
v&nbsp;pøípadì potøeby i vèetnì závislých balíèkù, nebo umí zkontrolovat, 
zda nìkterý z balíèkù není dostupný v&nbsp;novìj¹í verzi a pokud ano, umí 
balíèek aktualizovat. Informace o dostupných balíècích získává 
z&nbsp;tzv.&nbsp;<em>repository</em>, co¾ je specializovaný server
se sadou RPM balíèkù. Seznam dotazovaných repositories naleznete v adresáøi
<tt>/etc/yum.repos.d/</tt>.
</p>
<h4>Pøíklady</h4>
<table>
<!-- <tr><td></td><td></td></tr> -->
<tr><td><code>yum install balik&nbsp;&nbsp;&nbsp;</code></td><td>stáhne a nainstaluje balik.rpm</td></tr>
<tr><td><code>yum update</code></td><td>zjistí aktuální dostupné verze v¹ech
nainstalovaných balíkù a v pøípadì potøeby provede aktualizaci</td></tr>
</table>
<h3>Cvièení 1</h3>
<p>
Zjistìte, jaké v¹echny balíèky jsou nainstalovány. Kolik jich celkem je?
</p>
<h3>Cvièení 2</h3>
<p>
Vyberte si libovolný balíèek a zjistìte, jaké jsou jeho závislosti.
</p>
<h3>Cvièení 3</h3>
<p>
U vybraného balíèku je¹tì vypi¹te v¹echny soubory, které obsahuje.
</p>
<h3>Cvièení 4</h3>
<p>
Kterému balíèku patøí soubor <tt>/usr/bin/less</tt>?
</p>
<h3>Cvièení 5</h3>
<p>
Doká¾ete odvodit algoritmus, který by vypsal seznam nepotøebných balíèkù 
(na nich¾ nic nezávisí)? 
Doká¾ete jej napsat? 
Pokud ne, je nejvy¹¹í èas zopakovat si pou¾ití shellu (Y36UOS),
jeho¾ zvládnutí v&nbsp;tomto pøedmìtu bereme jako prerekvizitu (=samozøejmost)!
</p>
<h3>Bodované úlohy</h3>
<p>
Vyøe¹te bodované úlohy zadané cvièícím a pøedveïte mu jejich správná øe¹ení.
</p>
<hr />
<p><img src="http://moon.felk.cvut.cz/~zdarekj/obr/ESFgrant.png" width="161" height="22" alt="Partially supported by ESF and City of Prague." /></p>
</body>
</html>
